//
jclass getMinecraftClass1_8_9() {
    jclass cls = ct.env->FindClass("ave");
    logMessage(cls != nullptr ? "found getMinecraftClass1_8_9" : "not found getMinecraftClass1_8_9");
    if (cls == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }
    return cls;
}

jobject getMinecraft1_8_9() {
    jmethodID getMinecraftMethod = ct.env->GetStaticMethodID(getMinecraftClass1_8_9(), "A", "()Lave;");
    logMessage(getMinecraftMethod != nullptr ? "found getMinecraftMethod1_8_9" : "not found getMinecraftMethod1_8_9");
    if (getMinecraftMethod == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }
    return ct.env->CallStaticObjectMethod(getMinecraftClass1_8_9(), getMinecraftMethod);
}

jobject getWorld1_8_9() {
    jclass minecraftClass = getMinecraftClass1_8_9();
    logMessage(minecraftClass != nullptr ? "found minecraftClass1_8_9" : "not found minecraftClass1_8_9");
    if (minecraftClass == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    jfieldID getWorldField = ct.env->GetFieldID(minecraftClass, "f", "Lbdb;");
    logMessage(getWorldField != nullptr ? "found getWorldField1_8_9" : "not found getWorldField1_8_9");
    if (getWorldField == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    jobject minecraftInstance = getMinecraft1_8_9();
    logMessage(getWorldField != nullptr ? "found minecraftInstance1_8_9" : "not found minecraftInstance1_8_9");
    if (minecraftInstance == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    jobject world = ct.env->GetObjectField(minecraftInstance, getWorldField);
    logMessage(getWorldField != nullptr ? "found world1_8_9" : "not found world1_8_9");
    if (world == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    return world;
}

jobject getPlayer1_8_9() {
    jclass minecraftClass = getMinecraftClass1_8_9();
    logMessage(minecraftClass != nullptr ? "found minecraftClass1_8_9" : "not found minecraftClass1_8_9");
    if (minecraftClass == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    jfieldID getPlayerField = ct.env->GetFieldID(minecraftClass, "h", "Lbew;");
    logMessage(getPlayerField != nullptr ? "found getPlayerField1_8_9" : "not found getPlayerField1_8_9");
    if (getPlayerField == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    jobject minecraftInstance = getMinecraft1_8_9();
    logMessage(minecraftInstance != nullptr ? "found minecraftInstance1_8_9" : "not found minecraftInstance1_8_9");
    if (minecraftInstance == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    jobject player = ct.env->GetObjectField(minecraftInstance, getPlayerField);
    logMessage(player != nullptr ? "found player1_8_9" : "not found player1_8_9");
    if (player == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return nullptr;
    }

    return player;
}

void setPlayerSprint1_8_9() {
    if (!GetAsyncKeyState('W') || GetAsyncKeyState('S') || GetAsyncKeyState(VK_LCONTROL)) return;

    jobject player = getPlayer1_8_9();
    if (player == nullptr) return;

    jclass playerClass = ct.env->GetObjectClass(player);
    if (playerClass == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return;
    }

    jmethodID setSprintingMethod = ct.env->GetMethodID(playerClass, "d", "(Z)V");
    logMessage(setSprintingMethod != nullptr ? "found setSprintingMethod1_8_9" : "not found setSprintingMethod1_8_9");
    if (setSprintingMethod == nullptr || ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
        return;
    }

    ct.env->CallBooleanMethod(player, setSprintingMethod, true);
    if (ct.env->ExceptionCheck()) {
        ct.env->ExceptionDescribe();
        ct.env->ExceptionClear();
    }
}
//